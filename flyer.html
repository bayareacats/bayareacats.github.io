---
layout: default
title: Flyer Download
permalink: /flyer/
---

<main class="page-content" aria-labelledby="flyer-download-title">
  <div class="wrapper">
    <h1 id="flyer-download-title">Flyer Download</h1>
    <p>You should be redirected to the Bay Area Cats flyer automatically. If that doesn't happen, please use the link below.</p>
    <p><a href="{{ '/resources/flyer.pdf' | relative_url }}">Download the flyer directly</a>.</p>
  </div>
</main>

<!-- No-JS fallback: immediate redirect to the PDF -->
<noscript>
  <meta http-equiv="refresh" content="0; url={{ '/resources/flyer.pdf' | relative_url }}">
</noscript>

<script>
  (function () {
    const redirectUrl = "{{ '/resources/flyer.pdf' | relative_url }}";
    const callbackFallbackMs = 800;   // wait for GA event callback
    const hardFallbackMs     = 1500;  // absolute max wait before redirect

    function go() {
      let redirected = false;

      // Hard fallback: always redirect after hardFallbackMs
      const hard = setTimeout(function () {
        if (!redirected) {
          redirected = true;
          window.location.href = redirectUrl;
        }
      }, hardFallbackMs);

      // If gtag exists, send event and redirect on callback
      if (typeof window.gtag === 'function') {
        const soft = setTimeout(function () {
          // If GA was slow, still go after callbackFallbackMs
          if (!redirected) {
            redirected = true;
            clearTimeout(hard);
            window.location.href = redirectUrl;
          }
        }, callbackFallbackMs);

        window.gtag('event', 'flyer_view', {
          flyer_id: 'brochure2025',
          event_callback: function () {
            if (!redirected) {
              redirected = true;
              clearTimeout(soft);
              clearTimeout(hard);
              window.location.href = redirectUrl;
            }
          },
          event_timeout: callbackFallbackMs - 100 // ensures callback fires
        });
      } else {
        // No GA on page: just redirect quickly
        setTimeout(function () {
          if (!redirected) {
            redirected = true;
            clearTimeout(hard);
            window.location.href = redirectUrl;
          }
        }, 200);
      }
    }

    // Fire as soon as DOM is ready (faster than 'load')
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', go);
    } else {
      go();
    }
  })();
</script>
